(function(){"use strict";var e={4330:function(e,n,t){var o=t(5130),s=t(6768);const i={style:{"margin-top":"1rem"}};function c(e,n,t,o,c,l){const a=(0,s.g2)("HomeView"),r=(0,s.g2)("ChatView");return(0,s.uX)(),(0,s.CE)("main",i,[this.showHome?((0,s.uX)(),(0,s.Wv)(a,{key:0,peerId:this.peerId,online:this.online,connections:this.connections,onDeleteConn:n[0]||(n[0]=e=>{this.deleteConn(e)}),onAddNewConnection:this.addNewConnection,onSelectedChat:n[1]||(n[1]=e=>l.handleChatSelected(e)),onPlaySound:this.playSound},null,8,["peerId","online","connections","onAddNewConnection","onPlaySound"])):this.selectedChat?((0,s.uX)(),(0,s.Wv)(r,{key:this.selectedChat.conn.connectionId,conn:this.selectedChat,onUpdateMessages:n[2]||(n[2]=e=>{this.selectedChat.messages=e}),onReConnect:n[3]||(n[3]=e=>this.reConnect(e)),onEditName:n[4]||(n[4]=e=>this.editName(e)),onPlaySound:this.playSound},null,8,["conn","onPlaySound"])):(0,s.Q3)("",!0)])}t(4114);var l=t.p+"media/new-notification-7-210334.018d07b5.mp3",a=t(4232);const r=e=>((0,s.Qi)("data-v-19bc54d3"),e=e(),(0,s.jt)(),e),d={class:"container"},h=r((()=>(0,s.Lk)("p",{style:{margin:"0"}},"Your ID",-1))),p={class:"grid"},u=r((()=>(0,s.Lk)("i",{class:"fas fa-copy"},null,-1))),m={key:0},f=r((()=>(0,s.Lk)("i",{class:"fas fa-add"},null,-1))),g=[f],C={style:{"margin-top":"2vh"},class:"container"},k=r((()=>(0,s.Lk)("h1",null,"Chats",-1))),v=["onClick","onContextmenu"],y={class:"grid",style:{"justify-content":"space-between"}},w={key:0,style:{display:"inline"}},b={key:0},I=r((()=>(0,s.Lk)("i",{class:"fas fa-link"},null,-1))),L=[I],_={key:1},x=r((()=>(0,s.Lk)("mark",null,"New",-1))),S=[x],j={style:{"font-size":"80%",color:"#fff3",margin:"0"}},E={style:{"margin-bottom":"3px",color:"#fff5"},class:"grid"};function O(e,n,t,i,c,l){return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",d,[h,(0,s.Lk)("div",p,[(0,s.Lk)("code",null,(0,a.v_)(this.peerId),1),(0,s.Lk)("span",{id:"copy-id",onClick:n[0]||(n[0]=(...e)=>this.copyPeerId&&this.copyPeerId(...e))},[u,(0,s.eW)(" Â  "),this.copied?((0,s.uX)(),(0,s.CE)("code",m,"Copied!")):(0,s.Q3)("",!0)])]),(0,s.Lk)("span",null,(0,a.v_)(this.online?"Online":"Offline"),1),(0,s.Lk)("button",{onClick:n[1]||(n[1]=(...e)=>l.addNewConnection&&l.addNewConnection(...e)),id:"add-new"},g)]),(0,s.Lk)("div",C,[k,((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(this.connections,((e,n)=>((0,s.uX)(),(0,s.CE)("div",{key:n},[(0,s.Lk)("button",{onClick:e=>this.$emit("selectedChat",n),style:{width:"100%","text-align":"start"},onContextmenu:(0,o.D$)((e=>this.deleteConn(n)),["prevent"])},[(0,s.Lk)("div",y,[(0,s.Lk)("div",null,[(0,s.Lk)("b",null,[(0,s.eW)((0,a.v_)(e.title||e.peerId)+" ",1),e?((0,s.uX)(),(0,s.CE)("div",w,[e.new?((0,s.uX)(),(0,s.CE)("span",b,L)):(0,s.Q3)("",!0),e.newMsg?((0,s.uX)(),(0,s.CE)("span",_,S)):(0,s.Q3)("",!0)])):(0,s.Q3)("",!0)]),(0,s.Lk)("p",j,[(0,s.Lk)("em",null,(0,a.v_)(e.peerId),1)]),(0,s.Lk)("p",E,(0,a.v_)(this.lastmsg(n)),1)])])],40,v)])))),128))])],64)}var X={data(){return{copied:!1}},components:{},emits:["addNewConnection","deleteConn","selectedChat"],props:["peerId","connections","online"],methods:{copyPeerId(){navigator.clipboard.writeText(this.peerId),this.copied=!0,setTimeout((()=>{this.copied=!1}),2e3)},addNewConnection(){this.$emit("addNewConnection")},deleteConn(e){let n=window.confirm("Are you sure you want to delete this connection?");n&&this.$emit("deleteConn",e)},lastmsg(e){let n=this.connections[e];if(n.messages.length>0){let e=n.messages[n.messages.length-1];return`${e.self?"You: ":""}${e.text.length>20?e.text.slice(0,20)+"...":e.text}`}return""}}},D=t(1241);const N=(0,D.A)(X,[["render",O],["__scopeId","data-v-19bc54d3"]]);var T=N;const $=e=>((0,s.Qi)("data-v-1976db1c"),e=e(),(0,s.jt)(),e),P={class:"container",style:{position:"relative"}},A=$((()=>(0,s.Lk)("i",{class:"fas fa-pen"},null,-1))),Q=[A],H=$((()=>(0,s.Lk)("i",{class:"fas fa-refresh"},null,-1))),M={style:{position:"relative",height:"85dvh"}},W={class:"chat-box",ref:"chatBox"},B={id:"text-box"},V={class:"text"},F=$((()=>(0,s.Lk)("br",null,null,-1))),J={class:"time"},K={key:0},G={style:{position:"absolute",bottom:"0",width:"100%"}},R=["disabled"],U=$((()=>(0,s.Lk)("i",{class:"fas fa-paper-plane"},null,-1))),Y=[U];function z(e,n,t,i,c,l){const r=(0,s.g2)("GreenDot");return(0,s.uX)(),(0,s.CE)("div",P,[(0,s.Lk)("header",null,[(0,s.Lk)("hgroup",null,[(0,s.Lk)("h5",null,[(0,s.eW)((0,a.v_)(this.conn.title||this.conn.peerId)+" ",1),(0,s.Lk)("button",{style:{scale:"0.7"},onClick:n[0]||(n[0]=e=>this.$emit("editName",this.conn.peerId))},Q)]),(0,s.Lk)("p",null,[this.online?((0,s.uX)(),(0,s.Wv)(r,{key:0})):(0,s.Q3)("",!0),(0,s.eW)(" "+(0,a.v_)(this.online?"Online":"Offline"),1)]),this.online?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("a",{key:0,href:"#",onClick:n[1]||(n[1]=e=>this.$emit("reConnect",this.conn.peerId))},[(0,s.eW)("Reconnect "),H]))])]),(0,s.Lk)("main",M,[(0,s.Lk)("div",W,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(this.messages,((e,n)=>((0,s.uX)(),(0,s.CE)("p",{key:n,class:(0,a.C4)({self:e.self,other:!e.self})},[(0,s.Lk)("span",B,[(0,s.Lk)("span",V,(0,a.v_)(e.text),1),F,(0,s.Lk)("span",J,[(0,s.eW)((0,a.v_)(new Date(e.timestamp).toLocaleTimeString())+" ",1),(new Date).toDateString()!=new Date(e.timestamp).toDateString()?((0,s.uX)(),(0,s.CE)("span",K,(0,a.v_)(new Date(e.timestamp).toLocaleDateString()),1)):(0,s.Q3)("",!0)])])],2)))),128))],512),(0,s.Lk)("div",G,[(0,s.Lk)("fieldset",{role:"group",disabled:!this.online},[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":n[2]||(n[2]=e=>this.message=e),type:"text",placeholder:"Type a message",ref:"messageInp"},null,512),[[o.Jo,this.message]]),(0,s.Lk)("button",{onClick:n[3]||(n[3]=(...e)=>this.send_message&&this.send_message(...e))},Y)],8,R)])])])}function q(e,n,t,o,i,c){return(0,s.uX)(),(0,s.CE)("div",{style:(0,a.Tr)({backgroundColor:this.color?this.color:"green"})},null,4)}var Z={props:["color"]};const ee=(0,D.A)(Z,[["render",q],["__scopeId","data-v-43d9352d"]]);var ne=ee,te={props:["conn"],components:{GreenDot:ne},data(){return{message:"",messages:[],online:!1}},watch:{messages:{handler(){this.$emit("updateMessages",this.messages)},deep:!0},conn:{handler(){this.online=this.conn.conn.open},deep:!0,immediate:!0}},methods:{send_message(){this.online?(this.conn.conn.send(this.message),this.messages.push({text:this.message,self:!0,timestamp:(new Date).getTime()}),this.$emit("playSound"),this.message="",this.$refs.messageInp.focus()):this.$emit("reConnect",this.conn.peerId)},scrollToBottom(){console.log("called"),this.$refs.chatBox.scrollTo(0,this.$refs.chatBox.clientHeight+this.$refs.chatBox.scrollHeight)}},created(){this.messages=this.conn.messages,this.conn.conn.on("data",(e=>{this.messages.push({text:e,self:!1,timestamp:(new Date).getTime()}),this.scrollToBottom(),this.$emit("playSound",this.conn.peerId)})),this.conn.conn.open?this.online=!0:this.conn.conn.on("open",(()=>{this.online=!0})),this.conn.conn.on("close",(()=>{this.online=!1})),this.conn.conn.on("error",(()=>{this.online=!1})),this.conn.conn.on("disconnected",(()=>{this.online=!1}))},mounted(){this.scrollToBottom()},unmouted(){this.conn.conn.close()}};const oe=(0,D.A)(te,[["render",z],["__scopeId","data-v-1976db1c"]]);var se=oe,ie=t(4933),ce={name:"App",data(){return{selectedChat:null,peer_obj:null,peerId:null,online:!1,connections:[],showHome:!0}},components:{HomeView:T,ChatView:se},watch:{connections:{handler(){let e=this.connections.map((e=>({peerId:e.peerId,messages:e.messages,title:e.title})));localStorage.setItem("nitchat30095069_connections",JSON.stringify(e))},deep:!0}},created(){this.getLocalConnections();let e=localStorage.getItem("nitchat30095069_peerId");e?(this.peerId=e,this.peer_obj=new ie.xM(e)):(this.peer_obj=new ie.xM,this.peer_obj.on("open",(e=>{this.peerId=e,localStorage.setItem("nitchat30095069_peerId",e)}))),this.peer_obj.on("open",(e=>{this.online=!0,this.peerId=e})),this.peer_obj.on("connection",(e=>{let n=this.connections.find((n=>n.peerId===e.peer));n?(n.conn=e,n.new=!0,e.on("data",(e=>{this.showHome&&(n.newMsg=!0,n.messages.push({text:e,self:!1,timestamp:(new Date).getTime()}),this.playSound())}))):this.connections.push({conn:e,peerId:e.peer,messages:[],new:!0,title:e.peer})}))},methods:{deleteConn(e){this.selectedChat&&this.selectedChat.peerId===this.connections[e].peerId&&(this.showHome=!0,this.selectedChat=null),this.connections[e].conn&&this.connections[e].open&&this.connections[e].conn.close(),this.connections.splice(e,1)},getLocalConnections(){let e=localStorage.getItem("nitchat30095069_connections");e&&(this.connections=JSON.parse(e).map((e=>({conn:null,peerId:e.peerId,messages:e.messages,title:e.title}))))},addNewConnection(){let e=prompt("Enter the peer ID");e&&this.connections.push({conn:null,peerId:e,messages:[],title:e})},handleChatSelected(e){this.showHome=!1;let n=this.connections[e];n.new&&(n.new=!1),n.conn&&n.conn.open?this.selectedChat=n:(n.conn=this.peer_obj.connect(n.peerId),n.conn.on("error",(e=>{alert("An error occured while connecting to the peer",e)}))),this.selectedChat=this.connections[e]},playSound(){let e=new Audio(l);e.play()},reConnect(e){let n=this.connections.find((n=>n.peerId===e));n.conn&&n.conn.open?this.selectedChat=n:(n.conn=this.peer_obj.connect(n.peerId),n.conn.on("error",(e=>{alert("Can't connect to the peer. Peer might be offline.",e.type)})))},editName(e){let n=prompt("Enter the new name");if(!n)return;let t=this.connections.find((n=>n.peerId===e));t.title=n}}};const le=(0,D.A)(ce,[["render",c]]);var ae=le,re=t(3497),de=t.n(re);de().init(),(0,o.Ef)(ae).mount("#app")}},n={};function t(o){var s=n[o];if(void 0!==s)return s.exports;var i=n[o]={exports:{}};return e[o].call(i.exports,i,i.exports,t),i.exports}t.m=e,function(){var e=[];t.O=function(n,o,s,i){if(!o){var c=1/0;for(d=0;d<e.length;d++){o=e[d][0],s=e[d][1],i=e[d][2];for(var l=!0,a=0;a<o.length;a++)(!1&i||c>=i)&&Object.keys(t.O).every((function(e){return t.O[e](o[a])}))?o.splice(a--,1):(l=!1,i<c&&(c=i));if(l){e.splice(d--,1);var r=s();void 0!==r&&(n=r)}}return n}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[o,s,i]}}(),function(){t.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(n,{a:n}),n}}(),function(){t.d=function(e,n){for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)}}(),function(){t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){t.p="/nitchat/"}(),function(){var e={524:0};t.O.j=function(n){return 0===e[n]};var n=function(n,o){var s,i,c=o[0],l=o[1],a=o[2],r=0;if(c.some((function(n){return 0!==e[n]}))){for(s in l)t.o(l,s)&&(t.m[s]=l[s]);if(a)var d=a(t)}for(n&&n(o);r<c.length;r++)i=c[r],t.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return t.O(d)},o=self["webpackChunknitchat"]=self["webpackChunknitchat"]||[];o.forEach(n.bind(null,0)),o.push=n.bind(null,o.push.bind(o))}();var o=t.O(void 0,[504],(function(){return t(4330)}));o=t.O(o)})();
//# sourceMappingURL=app.350312f0.js.map